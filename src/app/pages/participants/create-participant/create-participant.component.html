<div class="container-fluid">
  <!-- Page Title -->
  <app-page-title [breadcrumbItems]="breadcrumbItems" [title]="'participants.createTitle' | transloco">
  </app-page-title>

  <div class="row justify-content-center">
    <div class="col-xl-8 mx-auto">
      <div class="card shadow-sm border-0">
        <div class="card-body p-4">
          <h4 class="card-title text-center mb-4 text-primary">
            <i class="mdi mdi-account-multiple me-2"></i>Participantes
          </h4>

          <!-- Loading Indicator -->
          <div class="text-center py-4" *ngIf="isLoading">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">{{ 'app.loading' | transloco }}</span>
            </div>
          </div>

          <!-- Main Form -->
          <div *ngIf="participantForm; else noForm">
            <form [formGroup]="participantForm" (ngSubmit)="onSubmit()" novalidate>
              <div id="progressWizard">
                <ul
                  ngbNav
                  #progressWizard="ngbNav"
                  [(activeId)]="activeWizardStep"
                  class="nav-pills nav-justified bg-light form-wizard-header mb-3"
                >
                  <li [ngbNavItem]="1">
                    <a ngbNavLink class="rounded-0 pt-2 pb-2">
                      <i class="mdi mdi-account-circle me-1"></i>
                      <span class="d-none d-sm-inline">Datos Personales</span>
                    </a>
                    <ng-template ngbNavContent>
                      <p>
                        <ngb-progressbar
                          type="success"
                          [value]="16.6"
                          [striped]="true"
                          [animated]="true"
                          class="mb-3"
                          height="7px"
                        ></ngb-progressbar>
                      </p>
                      <div class="row" formGroupName="personalData">
                        <div class="col-12">
                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label obligatorio" for="firstName"> Primer Nombre </label>
                            <div class="col-md-9">
                              <input
                                type="text"
                                class="form-control"
                                [class.is-invalid]="hasFieldError('personalData.firstName')"
                                id="firstName"
                                name="firstName"
                                formControlName="firstName"
                              />
                              <div class="invalid-feedback" *ngIf="hasFieldError('personalData.firstName')">
                                {{ getFieldError('personalData.firstName') | transloco }}
                              </div>
                            </div>
                          </div>

                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label" for="secondName">Segundo Nombre</label>
                            <div class="col-md-9">
                              <input
                                type="text"
                                class="form-control"
                                id="secondName"
                                name="secondName"
                                formControlName="secondName"
                              />
                            </div>
                          </div>

                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label obligatorio" for="firstLastName">
                              Primer Apellido
                            </label>
                            <div class="col-md-9">
                              <input
                                type="text"
                                class="form-control"
                                [class.is-invalid]="hasFieldError('personalData.firstLastName')"
                                id="firstLastName"
                                name="firstLastName"
                                formControlName="firstLastName"
                              />
                              <div class="invalid-feedback" *ngIf="hasFieldError('personalData.firstLastName')">
                                {{ getFieldError('personalData.firstLastName') | transloco }}
                              </div>
                            </div>
                          </div>

                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label" for="secondLastName"> Segundo Apellido</label>
                            <div class="col-md-9">
                              <input
                                type="text"
                                class="form-control"
                                id="secondLastName"
                                name="secondLastName"
                                formControlName="secondLastName"
                              />
                            </div>
                          </div>
                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label obligatorio" for="phoneNumber">Celular</label>
                            <div class="col-md-9">
                              <input
                                type="text"
                                class="form-control"
                                [class.is-invalid]="hasFieldError('personalData.phoneNumber')"
                                id="phoneNumber"
                                name="phoneNumber"
                                formControlName="phoneNumber"
                              />
                              <div class="invalid-feedback" *ngIf="hasFieldError('personalData.phoneNumber')">
                                {{ getFieldError('personalData.phoneNumber') | transloco }}
                              </div>
                            </div>
                          </div>
                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label" for="email">Email</label>
                            <div class="col-md-9">
                              <input
                                type="email"
                                class="form-control"
                                [class.is-invalid]="hasFieldError('personalData.email')"
                                id="email"
                                name="email"
                                formControlName="email"
                              />
                              <div class="invalid-feedback" *ngIf="hasFieldError('personalData.email')">
                                {{ getFieldError('personalData.email') | transloco }}
                              </div>
                            </div>
                          </div>

                          <div class="row mb-3">
                            <label for="documentTypeId" class="col-md-3 col-form-label obligatorio">
                              Tipo de Documento
                            </label>
                            <div class="col-md-9">
                              <select
                                class="form-select"
                                [class.is-invalid]="hasFieldError('personalData.documentTypeId')"
                                id="documentTypeId"
                                formControlName="documentTypeId"
                              >
                                <option value="" disabled selected>Seleccione un tipo de documento</option>
                                <option value="Cédula de Ciudadanía">Cédula de Ciudadanía</option>
                                <option value="Tarjeta de Identidad">Tarjeta de Identidad</option>
                                <option value="Cédula de Extranjería">Cédula de Extranjería</option>
                                <option value="Pasaporte">Pasaporte</option>
                              </select>
                              <div class="invalid-feedback" *ngIf="hasFieldError('personalData.documentTypeId')">
                                {{ getFieldError('personalData.documentTypeId') | transloco }}
                              </div>
                            </div>
                          </div>

                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label obligatorio" for="documentNumber"
                              >Número de Documento
                            </label>
                            <div class="col-md-9">
                              <input
                                type="text"
                                class="form-control"
                                [class.is-invalid]="hasFieldError('personalData.documentNumber')"
                                id="documentNumber"
                                name="documentNumber"
                                formControlName="documentNumber"
                              />
                              <div class="invalid-feedback" *ngIf="hasFieldError('personalData.documentNumber')">
                                {{ getFieldError('personalData.documentNumber') | transloco }}
                              </div>
                            </div>
                          </div>

                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label obligatorio" for="address">Dirección </label>
                            <div class="col-md-9">
                              <input
                                type="text"
                                class="form-control"
                                [class.is-invalid]="hasFieldError('personalData.address')"
                                id="address"
                                name="address"
                                formControlName="address"
                              />
                              <div class="invalid-feedback" *ngIf="hasFieldError('personalData.address')">
                                {{ getFieldError('personalData.address') | transloco }}
                              </div>
                            </div>
                          </div>

                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label obligatorio" for="city">Ciudad </label>
                            <div class="col-md-9">
                              <input
                                type="text"
                                class="form-control"
                                [class.is-invalid]="hasFieldError('personalData.city')"
                                id="city"
                                name="city"
                                formControlName="city"
                              />
                              <div class="invalid-feedback" *ngIf="hasFieldError('personalData.city')">
                                {{ getFieldError('personalData.city') | transloco }}
                              </div>
                            </div>
                          </div>

                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label obligatorio" for="birthDate"
                              >Fecha de Nacimiento
                            </label>
                            <div class="col-md-9">
                              <input
                                type="date"
                                class="form-control"
                                [class.is-invalid]="hasFieldError('personalData.birthDate')"
                                id="birthDate"
                                name="birthDate"
                                formControlName="birthDate"
                              />
                              <div class="invalid-feedback" *ngIf="hasFieldError('personalData.birthDate')">
                                {{ getFieldError('personalData.birthDate') | transloco }}
                              </div>
                            </div>
                          </div>

                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label obligatorio" for="religiousAffiliation"
                              >Afiliación Religiosa
                            </label>
                            <div class="col-md-9">
                              <input
                                type="text"
                                class="form-control"
                                [class.is-invalid]="hasFieldError('personalData.religiousAffiliation')"
                                id="religiousAffiliation"
                                name="religiousAffiliation"
                                formControlName="religiousAffiliation"
                              />
                              <div class="invalid-feedback" *ngIf="hasFieldError('personalData.religiousAffiliation')">
                                {{ getFieldError('personalData.religiousAffiliation') | transloco }}
                              </div>
                            </div>
                          </div>

                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label" for="referralSource">Fuente Referido</label>
                            <div class="col-md-9">
                              <input
                                type="text"
                                class="form-control"
                                id="referralSource"
                                name="referralSource"
                                formControlName="referralSource"
                              />
                            </div>
                          </div>

                          <div class="row mb-3">
                            <label for="genderId" class="col-md-3 col-form-label obligatorio"> Género </label>
                            <div class="col-md-9">
                              <select
                                class="form-select"
                                [class.is-invalid]="hasFieldError('personalData.genderId')"
                                id="genderId"
                                formControlName="genderId"
                              >
                                <option value="" disabled selected>Seleccione el género</option>
                                <option value="Femenino">Femenino</option>
                                <option value="Masculino">Masculino</option>
                                <option value="Prefiero No Decirlo">Prefiero No Decirlo</option>
                              </select>
                              <div class="invalid-feedback" *ngIf="hasFieldError('personalData.genderId')">
                                {{ getFieldError('personalData.genderId') | transloco }}
                              </div>
                            </div>
                          </div>

                          <div class="row mb-3">
                            <label for="maritalStatusId" class="col-md-3 col-form-label obligatorio">
                              Estado Civil
                            </label>
                            <div class="col-md-9">
                              <select
                                class="form-select"
                                [class.is-invalid]="hasFieldError('personalData.maritalStatusId')"
                                id="maritalStatusId"
                                formControlName="maritalStatusId"
                              >
                                <option value="" disabled selected>Seleccione el estado civil</option>
                                <option value="Casado">Casado</option>
                                <option value="Divorciado">Divorciado</option>
                                <option value="Separado">Separado</option>
                                <option value="Soltero">Soltero</option>
                                <option value="Unión Libre">Unión Libre</option>
                                <option value="Viudo">Viudo</option>
                              </select>
                              <div class="invalid-feedback" *ngIf="hasFieldError('personalData.maritalStatusId')">
                                {{ getFieldError('personalData.maritalStatusId') | transloco }}
                              </div>
                            </div>
                          </div>

                          <div class="row mb-3">
                            <label for="healthInsuranceId" class="col-md-3 col-form-label obligatorio"> EPS </label>
                            <div class="col-md-9">
                              <select
                                class="form-select"
                                [class.is-invalid]="hasFieldError('personalData.healthInsuranceId')"
                                id="healthInsuranceId"
                                formControlName="healthInsuranceId"
                              >
                                <option value="" disabled selected>Seleccione la EPS</option>
                                <option value="Asmet Salud">Asmet Salud</option>
                                <option value="Asociación Indígena del Cauca">Asociación Indígena del Cauca</option>
                                <option value="Cafesalud">Cafesalud</option>
                                <option value="Capital Salud">Capital Salud</option>
                                <option value="Comfachocó">Comfachocó</option>
                                <option value="Comfamiliar">Comfamiliar</option>
                                <option value="Comfandi">Comfandi</option>
                                <option value="Comfenalco">Comfenalco</option>
                                <option value="Compensar">Compensar</option>
                                <option value="Coosalud">Coosalud</option>
                                <option value="Cruz blanca">Cruz blanca</option>
                                <option value="Emssanar">Emssanar</option>
                                <option value="EPS Sanitas">EPS Sanitas</option>
                                <option value="Famisanar">Famisanar</option>
                                <option value="Ferrocarriles">Ferrocarriles</option>
                                <option value="Fomag (magisterio)">Fomag (magisterio)</option>
                                <option value="Mallamas">Mallamas</option>
                                <option value="Mutual SER">Mutual SER</option>
                                <option value="Nueva EPS">Nueva EPS</option>
                                <option value="Pijaos Salud">Pijaos Salud</option>
                                <option value="Policía Nacional">Policía Nacional</option>
                                <option value="Salud Bolívar">Salud Bolívar</option>
                                <option value="Salud Total">Salud Total</option>
                                <option value="Savia Salud">Savia Salud</option>
                                <option value="Servicio Occidental de Salud EPS SOS">
                                  Servicio Occidental de Salud EPS SOS
                                </option>
                                <option value="Suramericana">Suramericana</option>
                                <option value="Sura">Sura</option>
                              </select>
                              <div class="invalid-feedback" *ngIf="hasFieldError('personalData.healthInsuranceId')">
                                {{ getFieldError('personalData.healthInsuranceId') | transloco }}
                              </div>
                            </div>
                          </div>

                          <div class="row mb-3">
                            <label for="housingTypeId" class="col-md-3 col-form-label obligatorio">
                              Tipo de Vivienda
                            </label>
                            <div class="col-md-9">
                              <select
                                class="form-select"
                                [class.is-invalid]="hasFieldError('personalData.housingTypeId')"
                                id="housingTypeId"
                                formControlName="housingTypeId"
                              >
                                <option value="" disabled selected>Seleccione el Tipo de Vivienda</option>
                                <option value="Propia">Propia</option>
                                <option value="Arriendo">Arriendo</option>
                                <option value="Familiar">Familiar</option>
                              </select>
                              <div class="invalid-feedback" *ngIf="hasFieldError('personalData.housingTypeId')">
                                {{ getFieldError('personalData.housingTypeId') | transloco }}
                              </div>
                            </div>
                          </div>
                        </div>
                        <!-- end col -->
                      </div>
                      <!-- end row -->
                      <ul class="list-inline mb-0 wizard">
                        <li class="next list-inline-item float-end">
                          <button type="button" (click)="goToNextStep()" class="btn btn-secondary">Siguiente</button>
                        </li>
                      </ul>
                    </ng-template>
                  </li>
                  <li [ngbNavItem]="2">
                    <a ngbNavLink class="rounded-0 pt-2 pb-2">
                      <i class="mdi mdi-face-profile me-1"></i>
                      <span class="d-none d-sm-inline">Composición Familiar</span>
                    </a>
                    <ng-template ngbNavContent>
                      <p>
                        <ngb-progressbar
                          type="success"
                          [value]="33.3"
                          [striped]="true"
                          [animated]="true"
                          class="mb-3"
                          height="7px"
                        >
                        </ngb-progressbar>
                      </p>
                      <div class="row" formGroupName="familyComposition">
                        <div class="col-12">
                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label obligatorio" for="name"> Nombre</label>
                            <div class="col-md-9">
                              <input
                                type="text"
                                id="name"
                                name="name"
                                class="form-control"
                                [class.is-invalid]="hasFieldError('familyComposition.name')"
                                formControlName="name"
                              />
                              <div class="invalid-feedback" *ngIf="hasFieldError('familyComposition.name')">
                                {{ getFieldError('familyComposition.name') | transloco }}
                              </div>
                            </div>
                          </div>
                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label" for="familyBirthDate"> Fecha de Nacimiento</label>
                            <div class="col-md-9">
                              <input
                                type="date"
                                id="familyBirthDate"
                                name="familyBirthDate"
                                class="form-control"
                                formControlName="birthDate"
                              />
                            </div>
                          </div>

                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label" for="occupation">Ocupación</label>
                            <div class="col-md-9">
                              <input
                                type="text"
                                id="occupation"
                                name="occupation"
                                class="form-control"
                                formControlName="occupation"
                              />
                            </div>
                          </div>

                          <div class="row mb-3">
                            <label for="relationshipId" class="col-md-3 col-form-label"> Parentesco </label>
                            <div class="col-md-9">
                              <select class="form-select" id="relationshipId" formControlName="relationshipId">
                                <option value="" disabled selected>Seleccione el Parentesco</option>
                                <option value="Padre">Padre</option>
                                <option value="Madre">Madre</option>
                                <option value="Hermano">Hermano</option>
                                <option value="Tio">Tio</option>
                                <option value="Abuelo">Abuelo</option>
                                <option value="Primo">Primo</option>
                              </select>
                            </div>
                          </div>

                          <div class="row mb-3">
                            <label for="academicLevelId" class="col-md-3 col-form-label"> Grado Académico </label>
                            <div class="col-md-9">
                              <select class="form-select" id="academicLevelId" formControlName="academicLevelId">
                                <option value="" disabled selected>Seleccione el Grado Académico</option>
                                <option value="Sin Grado Académico">Sin Grado Académico</option>
                                <option value="Preescolar">Preescolar</option>
                                <option value="Primaria">Primaria</option>
                                <option value="Técnico">Técnico</option>
                                <option value="Tecnólogo">Tecnólogo</option>
                                <option value="Pregrado">Pregrado</option>
                                <option value="Especialización">Especialización</option>
                                <option value="Maestria">Maestria</option>
                                <option value="Doctorado">Doctorado</option>
                                <option value="Postdoctorado">Postdoctorado</option>
                              </select>
                            </div>
                          </div>
                        </div>
                        <!-- end col -->
                      </div>
                      <!-- end row -->

                      <ul class="list-inline mb-0 wizard">
                        <li class="previous list-inline-item">
                          <button type="button" (click)="goToPreviousStep()" class="btn btn-secondary">Anterior</button>
                        </li>
                        <li class="next list-inline-item float-end">
                          <button type="button" (click)="goToNextStep()" class="btn btn-secondary">Siguiente</button>
                        </li>
                      </ul>
                    </ng-template>
                  </li>
                  <!-- Agrega este nuevo li después del paso 6 existente -->
                  <li [ngbNavItem]="3">
                    <a ngbNavLink class="rounded-0 pt-2 pb-2">
                      <i class="mdi mdi-school me-1"></i>
                      <span class="d-none d-sm-inline">Historial Académico</span>
                    </a>
                    <ng-template ngbNavContent>
                      <p>
                        <ngb-progressbar
                          type="success"
                          [value]="100"
                          [striped]="true"
                          [animated]="true"
                          class="mb-3"
                          height="7px"
                        ></ngb-progressbar>
                      </p>
                      <div class="row" formGroupName="bioPsychosocialHistory">
                        <div class="col-12">
                          <!-- Escolaridad -->
                          <div class="row mb-3">
                            <label for="schooling" class="col-md-3 col-form-label"> Escolaridad </label>
                            <div class="col-md-9">
                              <select class="form-select" id="schooling" formControlName="schooling">
                                <option value="" disabled selected>Seleccione escolaridad</option>
                                <option value="Primaria">Primaria</option>
                                <option value="Secundaria">Secundaria</option>
                                <option value="Técnico">Técnico</option>
                                <option value="Tecnólogo">Tecnólogo</option>
                                <option value="Universidad">Universidad</option>
                                <option value="Especialización">Especialización</option>
                                <option value="Maestría">Maestría</option>
                                <option value="Doctorado">Doctorado</option>
                                <option value="No tiene estudios">No tiene estudios</option>
                              </select>
                            </div>
                          </div>

                          <!-- Grado completado -->
                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label" for="completedGrade"> Grado completado </label>
                            <div class="col-md-9">
                              <input
                                type="text"
                                class="form-control"
                                id="completedGrade"
                                formControlName="completedGrade"
                              />
                            </div>
                          </div>

                          <!-- Escuela o universidad -->
                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label" for="institution"> Escuela o universidad </label>
                            <div class="col-md-9">
                              <input type="text" class="form-control" id="institution" formControlName="institution" />
                            </div>
                          </div>

                          <!-- Profesión -->
                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label" for="profession"> Profesión </label>
                            <div class="col-md-9">
                              <input type="text" class="form-control" id="profession" formControlName="profession" />
                            </div>
                          </div>

                          <!-- Fuente de ingresos -->
                          <div class="row mb-3">
                            <label for="incomeSource" class="col-md-3 col-form-label"> Fuente de ingresos </label>
                            <div class="col-md-9">
                              <select class="form-select" id="incomeSource" formControlName="incomeSource">
                                <option value="" disabled selected>Seleccione fuente de ingresos</option>
                                <option value="Sueldo">Sueldo</option>
                                <option value="Rentas">Rentas</option>
                                <option value="Seguro">Seguro</option>
                                <option value="Pensiones">Pensiones</option>
                                <option value="Giros">Giros</option>
                                <option value="Negocio propio">Negocio propio</option>
                              </select>
                            </div>
                          </div>

                          <!-- Estimado mensual -->
                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label" for="incomeLevel">
                              Estimado mensual (en salarios mínimos)
                            </label>
                            <div class="col-md-9">
                              <input
                                type="text"
                                class="form-control"
                                id="incomeLevel"
                                formControlName="incomeLevel"
                                placeholder="Ej: Menos de 1 SMLV, 1 SMLV, Más de 1 SMLV"
                              />
                            </div>
                          </div>

                          <!-- Historial ocupacional -->
                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label" for="occupationalHistory">
                              Historial ocupacional
                            </label>
                            <div class="col-md-9">
                              <textarea
                                class="form-control"
                                id="occupationalHistory"
                                formControlName="occupationalHistory"
                                rows="3"
                                placeholder="Describa el historial ocupacional..."
                              ></textarea>
                            </div>
                          </div>

                          <!-- Vivienda -->
                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label" for="housing"> Vivienda </label>
                            <div class="col-md-9">
                              <textarea
                                class="form-control"
                                id="housing"
                                formControlName="housing"
                                rows="3"
                                placeholder="Describa las condiciones de vivienda..."
                              ></textarea>
                            </div>
                          </div>
                        </div>
                      </div>

                      <ul class="list-inline mb-0 wizard">
                        <li class="previous list-inline-item">
                          <button type="button" class="btn btn-secondary" (click)="goToPreviousStep()">Anterior</button>
                        </li>
                        <li class="next list-inline-item float-end">
                          <button type="button" class="btn btn-primary" (click)="goToNextStep()">Siguiente</button>
                        </li>
                      </ul>
                    </ng-template>
                  </li>

                  <li [ngbNavItem]="4">
                    <a ngbNavLink class="rounded-0 pt-2 pb-2">
                      <i class="mdi mdi-checkbox-marked-circle-outline me-1"></i>
                      <span class="d-none d-sm-inline">Motivo de consulta</span>
                    </a>
                    <ng-template ngbNavContent>
                      <p>
                        <ngb-progressbar
                          type="success"
                          [value]="49.3"
                          [striped]="true"
                          [animated]="true"
                          class="mb-3"
                          height="7px"
                        >
                        </ngb-progressbar>
                      </p>
                      <div class="row" formGroupName="consultationReason">
                        <div class="col-12">
                          <div class="row mb-3">
                            <textarea
                              class="form-control"
                              id="reason"
                              formControlName="reason"
                              rows="4"
                              placeholder="Escriba el motivo de la consulta aquí..."
                            ></textarea>
                          </div>
                        </div>
                      </div>
                      <!-- end row -->

                      <div class="float-end">
                        <input
                          type="button"
                          class="btn btn-secondary button-last me-1"
                          (click)="goToPreviousStep()"
                          name="last"
                          value="Anterior"
                        />
                        <input
                          type="button"
                          class="btn btn-secondary button-next"
                          (click)="goToNextStep()"
                          name="next"
                          value="Siguiente"
                        />
                      </div>
                    </ng-template>
                  </li>
                  <li [ngbNavItem]="5">
                    <a ngbNavLink class="rounded-0 pt-2 pb-2">
                      <i class="mdi mdi-checkbox-marked-circle-outline me-1"></i>
                      <span class="d-none d-sm-inline">Situaciones Identificadas</span>
                    </a>
                    <ng-template ngbNavContent>
                      <p>
                        <ngb-progressbar
                          type="success"
                          [value]="66"
                          [striped]="true"
                          [animated]="true"
                          class="mb-3"
                          height="7px"
                        >
                        </ngb-progressbar>
                      </p>

                      <div class="row" formGroupName="identifiedSituations">
                        <label class="col-md-12 col-form-label">Seleccione los motivos de consulta:</label>
                        <div class="col-md-4">
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              value="Orientación general"
                              id="orientacionGeneral"
                              formControlName="situations"
                            />
                            <label class="form-check-label" for="orientacionGeneral"> Orientación general </label>
                          </div>
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              value="Vivienda"
                              id="vivienda"
                              formControlName="situations"
                            />
                            <label class="form-check-label" for="vivienda"> Vivienda </label>
                          </div>
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              value="Falta de empleo"
                              id="faltaDeEmpleo"
                              formControlName="situations"
                            />
                            <label class="form-check-label" for="faltaDeEmpleo"> Falta de empleo </label>
                          </div>
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              value="Baja autoestima"
                              id="bajaAutoestima"
                              formControlName="situations"
                            />
                            <label class="form-check-label" for="bajaAutoestima"> Baja autoestima </label>
                          </div>
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              value="Estrés"
                              id="estres"
                              formControlName="situations"
                            />
                            <label class="form-check-label" for="estres"> Estrés </label>
                          </div>
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              value="Conducta agresiva"
                              id="conductaAgresiva"
                              formControlName="situations"
                            />
                            <label class="form-check-label" for="conductaAgresiva"> Conducta agresiva </label>
                          </div>
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              value="Violencia en el hogar"
                              id="violenciaHogar"
                              formControlName="situations"
                            />
                            <label class="form-check-label" for="violenciaHogar"> Violencia en el hogar </label>
                          </div>
                        </div>

                        <div class="col-md-4">
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              value="Embarazo adolescente"
                              id="embarazoAdolescente"
                              formControlName="situations"
                            />
                            <label class="form-check-label" for="embarazoAdolescente"> Embarazo adolescente </label>
                          </div>
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              value="Depresión"
                              id="depresion"
                              formControlName="situations"
                            />
                            <label class="form-check-label" for="depresion"> Depresión </label>
                          </div>
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              value="Problemas psiquiátricos"
                              id="problemasPsiquiatricos"
                              formControlName="situations"
                            />
                            <label class="form-check-label" for="problemasPsiquiatricos">
                              Problemas psiquiátricos
                            </label>
                          </div>
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              value="Problemas familiares"
                              id="problemasFamiliares"
                              formControlName="situations"
                            />
                            <label class="form-check-label" for="problemasFamiliares"> Problemas familiares </label>
                          </div>
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              value="Conflictos maritales"
                              id="conflictosMaritales"
                              formControlName="situations"
                            />
                            <label class="form-check-label" for="conflictosMaritales"> Conflictos maritales </label>
                          </div>
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              value="Crisis de divorcio"
                              id="crisisDivorcio"
                              formControlName="situations"
                            />
                            <label class="form-check-label" for="crisisDivorcio"> Crisis de divorcio </label>
                          </div>
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              value="Abuso de alcohol"
                              id="abusoAlcohol"
                              formControlName="situations"
                            />
                            <label class="form-check-label" for="abusoAlcohol">
                              Abuso de alcohol (propio, otras personas)
                            </label>
                          </div>
                        </div>

                        <div class="col-md-4">
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              value="Problemas financieros"
                              id="problemasFinancieros"
                              formControlName="situations"
                            />
                            <label class="form-check-label" for="problemasFinancieros"> Problemas financieros </label>
                          </div>
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              value="Desórdenes alimenticios"
                              id="desordenesAlimenticios"
                              formControlName="situations"
                            />
                            <label class="form-check-label" for="desordenesAlimenticios">
                              Desórdenes alimenticios
                            </label>
                          </div>
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              value="Problemas espirituales"
                              id="problemasEspirituales"
                              formControlName="situations"
                            />
                            <label class="form-check-label" for="problemasEspirituales"> Problemas espirituales </label>
                          </div>
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              value="Seguro social"
                              id="seguroSocial"
                              formControlName="situations"
                            />
                            <label class="form-check-label" for="seguroSocial"> Seguro social </label>
                          </div>
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              value="Problemas con alguna agencia gubernamental"
                              id="problemasAgenciaGubernamental"
                              formControlName="situations"
                            />
                            <label class="form-check-label" for="problemasAgenciaGubernamental">
                              Problemas con alguna agencia gubernamental
                            </label>
                          </div>
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              value="Uso de drogas ilícitas"
                              id="usoDrogasIlicitas"
                              formControlName="situations"
                            />
                            <label class="form-check-label" for="usoDrogasIlicitas"> Uso de drogas ilícitas </label>
                          </div>
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              value="Otros"
                              id="otros"
                              formControlName="situations"
                            />
                            <label class="form-check-label" for="otros"> Otros: </label>
                          </div>
                        </div>
                      </div>

                      <div class="float-end">
                        <input
                          type="button"
                          class="btn btn-secondary button-last me-1"
                          (click)="goToPreviousStep()"
                          name="last"
                          value="Anterior"
                        />
                        <input
                          type="button"
                          class="btn btn-secondary button-next"
                          (click)="goToNextStep()"
                          name="next"
                          value="Siguiente"
                        />
                      </div>
                      <div class="clearfix"></div>
                    </ng-template>
                  </li>

                  <li [ngbNavItem]="6">
                    <a ngbNavLink class="rounded-0 pt-2 pb-2">
                      <i class="mdi mdi-checkbox-marked-circle-outline me-1"></i>
                      <span class="d-none d-sm-inline">Intervención</span>
                    </a>

                    <ng-template ngbNavContent>
                      <p>
                        <ngb-progressbar
                          type="success"
                          [value]="83"
                          [striped]="true"
                          [animated]="true"
                          class="mb-3"
                          height="7px"
                        >
                        </ngb-progressbar>
                      </p>
                      <div class="row" formGroupName="intervention">
                        <div class="col-12">
                          <div class="row mb-3">
                            <textarea
                              class="form-control"
                              id="intervention"
                              formControlName="intervention"
                              rows="4"
                              placeholder="Registre el plan a seguir aquí..."
                            ></textarea>
                          </div>
                        </div>
                      </div>
                      <!-- end row -->
                      <div class="float-end">
                        <input
                          type="button"
                          class="btn btn-secondary button-last me-1"
                          (click)="goToPreviousStep()"
                          name="last"
                          value="Anterior"
                        />
                        <input
                          type="button"
                          class="btn btn-secondary button-next"
                          (click)="goToNextStep()"
                          name="next"
                          value="Siguiente"
                        />
                      </div>
                      <div class="clearfix"></div>
                    </ng-template>
                  </li>
                  <li [ngbNavItem]="7">
                    <a ngbNavLink class="rounded-0 pt-2 pb-2">
                      <i class="mdi mdi-checkbox-marked-circle-outline me-1"></i>
                      <span class="d-none d-sm-inline">Plan A Seguir</span>
                    </a>
                    <ng-template ngbNavContent>
                      <p>
                        <ngb-progressbar
                          type="success"
                          [value]="100"
                          [striped]="true"
                          [animated]="true"
                          class="mb-3"
                          height="7px"
                        >
                        </ngb-progressbar>
                      </p>
                      <div class="row" formGroupName="followUpPlan">
                        <div class="row mb-3">
                          <label class="col-md-12 col-form-label">Seleccione una opción:</label>
                          <div class="col-md-12">
                            <div class="form-check">
                              <input
                                class="form-check-input"
                                type="radio"
                                formControlName="plan"
                                value="Se culminó el proceso de ayuda"
                                id="culminoProceso"
                              />
                              <label class="form-check-label" for="culminoProceso">
                                Se culminó el proceso de ayuda
                              </label>
                            </div>

                            <div class="form-check">
                              <input
                                class="form-check-input"
                                type="radio"
                                formControlName="plan"
                                value="Se coordinó servicios en (mencionar agencia)"
                                id="coordinoServicios"
                              />
                              <label class="form-check-label" for="coordinoServicios">
                                Se coordinó servicios en (mencionar agencia)
                              </label>
                            </div>

                            <div class="form-check">
                              <input
                                class="form-check-input"
                                type="radio"
                                formControlName="plan"
                                value="Se hará un referido (mencionar los referidos y justificar)"
                                id="haraReferido"
                              />
                              <label class="form-check-label" for="haraReferido">
                                Se hará un referido (mencionar los referidos y justificar)
                              </label>
                            </div>

                            <div class="form-check">
                              <input
                                class="form-check-input"
                                type="radio"
                                formControlName="plan"
                                value="Se coordinó cita para iniciar proceso de orientación"
                                id="coordinoCita"
                              />
                              <label class="form-check-label" for="coordinoCita">
                                Se coordinó cita para iniciar proceso de orientación
                              </label>
                            </div>

                            <div class="form-check">
                              <input
                                class="form-check-input"
                                type="radio"
                                formControlName="plan"
                                value="Otros"
                                id="otros"
                              />
                              <label class="form-check-label" for="otros"> Otros </label>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!-- end row -->

                      <ul class="list-inline mb-0 wizard">
                        <div class="float-end">
                          <li class="previous list-inline-item">
                            <button class="btn btn-secondary" (click)="goToPreviousStep()">Anterior</button>
                          </li>
                          <li class="next list-inline-item float-end">
                            <button type="submit" class="btn btn-primary">Enviar</button>
                          </li>
                        </div>
                      </ul>
                    </ng-template>
                  </li>
                  <!-- Historial de Salud Física -->
                  <li [ngbNavItem]="8">
                    <a ngbNavLink class="rounded-0 pt-2 pb-2">
                      <i class="mdi mdi-heart-pulse me-1"></i>
                      <span class="d-none d-sm-inline">Historial Salud Física</span>
                    </a>
                    <ng-template ngbNavContent>
                      <!-- Contenido similar al anterior pero para salud física -->
                      <div class="row" formGroupName="physicalHealthHistory">
                        <div class="col-12">
                          <h5>Condiciones físicas del participante</h5>
                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label"
                              >¿Tiene usted un diagnóstico de salud física? ¿Cuál?</label
                            >
                            <div class="col-md-9">
                              <textarea class="form-control" formControlName="physicalConditions" rows="3"></textarea>
                            </div>
                          </div>

                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label"
                              >¿Actualmente recibe algún tipo de tratamiento?</label
                            >
                            <div class="col-md-9">
                              <div class="form-check form-check-inline">
                                <input
                                  class="form-check-input"
                                  type="radio"
                                  formControlName="receivingTreatment"
                                  value="Sí"
                                  id="tratamientoSi"
                                />
                                <label class="form-check-label" for="tratamientoSi">Sí</label>
                              </div>
                              <div class="form-check form-check-inline">
                                <input
                                  class="form-check-input"
                                  type="radio"
                                  formControlName="receivingTreatment"
                                  value="No"
                                  id="tratamientoNo"
                                />
                                <label class="form-check-label" for="tratamientoNo">No</label>
                              </div>
                            </div>
                          </div>

                          @if ( participantForm.get( 'physicalHealthHistory.receivingTreatment' )?.value === 'Sí' ) {
                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label">Medicamentos o terapia</label>
                            <div class="col-md-9">
                              <input type="text" class="form-control" formControlName="treatmentDetails" />
                            </div>
                          </div>
                          }

                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label">Antecedentes familiares de salud física</label>
                            <div class="col-md-9">
                              <div class="row">
                                <div class="col-md-6">
                                  <label>Familia paterna</label>
                                  <textarea
                                    class="form-control"
                                    formControlName="paternalFamilyHistory"
                                    rows="3"
                                  ></textarea>
                                </div>
                                <div class="col-md-6">
                                  <label>Familia materna</label>
                                  <textarea
                                    class="form-control"
                                    formControlName="maternalFamilyHistory"
                                    rows="3"
                                  ></textarea>
                                </div>
                              </div>
                            </div>
                          </div>

                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label">Observaciones sobre salud física:</label>
                            <div class="col-md-9">
                              <textarea
                                class="form-control"
                                formControlName="physicalHealthObservations"
                                rows="3"
                              ></textarea>
                            </div>
                          </div>

                          <!-- Botones de navegación -->
                          <ul class="list-inline mb-0 wizard">
                            <li class="previous list-inline-item">
                              <button type="button" class="btn btn-secondary" (click)="goToPreviousStep()">
                                Anterior
                              </button>
                            </li>
                            <li class="next list-inline-item float-end">
                              <button type="button" class="btn btn-secondary" (click)="goToNextStep()">
                                Siguiente
                              </button>
                            </li>
                          </ul>
                        </div>
                      </div>
                      <!-- Botones de navegación -->
                    </ng-template>
                  </li>

                  <!-- Historial de Salud Mental -->
                  <li [ngbNavItem]="9">
                    <a ngbNavLink class="rounded-0 pt-2 pb-2">
                      <i class="mdi mdi-brain me-1"></i>
                      <span class="d-none d-sm-inline">Historial Salud Mental</span>
                    </a>
                    <ng-template ngbNavContent>
                      <p>
                        <ngb-progressbar
                          type="info"
                          [value]="100"
                          [striped]="true"
                          [animated]="true"
                          class="mb-3"
                          height="7px"
                        ></ngb-progressbar>
                      </p>

                      <div class="row" formGroupName="mentalHealthHistory">
                        <div class="col-12">
                          <h5 class="mb-3">Historial mental del participante</h5>

                          <!-- Condiciones mentales -->
                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label"
                              >¿Tiene usted un diagnóstico de salud mental? ¿Cuál?</label
                            >
                            <div class="col-md-9">
                              <textarea
                                class="form-control"
                                formControlName="mentalConditions"
                                rows="3"
                                placeholder="Describa las condiciones mentales del participante..."
                              ></textarea>
                            </div>
                          </div>

                          <!-- Recibe tratamiento -->
                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label">¿Actualmente recibe Tratamiento?</label>
                            <div class="col-md-9">
                              <div class="form-check form-check-inline">
                                <input
                                  class="form-check-input"
                                  type="radio"
                                  formControlName="receivingMentalTreatment"
                                  value="Sí"
                                  id="tratamientoMentalSi"
                                />
                                <label class="form-check-label" for="tratamientoMentalSi">Sí</label>
                              </div>
                              <div class="form-check form-check-inline">
                                <input
                                  class="form-check-input"
                                  type="radio"
                                  formControlName="receivingMentalTreatment"
                                  value="No"
                                  id="tratamientoMentalNo"
                                />
                                <label class="form-check-label" for="tratamientoMentalNo">No</label>
                              </div>
                            </div>
                          </div>

                          <!-- Detalles del tratamiento (mostrar solo si es Sí) -->
                          @if ( participantForm.get( 'mentalHealthHistory.receivingMentalTreatment' )?.value === 'Sí' )
                          {
                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label">Medicamentos y/o terapia</label>
                            <div class="col-md-9">
                              <input
                                type="text"
                                class="form-control"
                                formControlName="mentalTreatmentDetails"
                                placeholder="Especifique los medicamentos o tipo de terapia..."
                              />
                            </div>
                          </div>
                          }

                          <!-- Historial familiar -->
                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label">Antecedentes familiares de salud mental</label>
                            <div class="col-md-9">
                              <div class="row">
                                <div class="col-md-6 mb-2">
                                  <label class="form-label">Familia paterna</label>
                                  <textarea
                                    class="form-control"
                                    formControlName="paternalMentalHistory"
                                    rows="3"
                                    placeholder="Describa condiciones mentales en familia paterna..."
                                  ></textarea>
                                </div>
                                <div class="col-md-6">
                                  <label class="form-label">Familia materna</label>
                                  <textarea
                                    class="form-control"
                                    formControlName="maternalMentalHistory"
                                    rows="3"
                                    placeholder="Describa condiciones mentales en familia materna..."
                                  ></textarea>
                                </div>
                              </div>
                            </div>
                          </div>

                          <!-- Otras observaciones -->
                          <div class="row mb-3">
                            <label class="col-md-3 col-form-label">Observaciones sobre salud mental:</label>
                            <div class="col-md-9">
                              <textarea
                                class="form-control"
                                formControlName="mentalHealthObservations"
                                rows="3"
                                placeholder="Agregue cualquier otra observación relevante..."
                              ></textarea>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Botones de navegación -->
                      <ul class="list-inline mb-0 wizard">
                        <div class="float-end">
                          <li class="previous list-inline-item">
                            <button class="btn btn-secondary" (click)="goToPreviousStep()">
                              <i class="mdi mdi-arrow-left me-1"></i> Anterior
                            </button>
                          </li>
                          <li class="next list-inline-item float-end">
                            <button type="button" class="btn btn-primary" (click)="goToNextStep()">
                              Siguiente <i class="mdi mdi-arrow-right ms-1"></i>
                            </button>
                          </li>
                        </div>
                      </ul>
                    </ng-template>
                  </li>

                  <!-- Ponderación -->
                  <li [ngbNavItem]="10">
                    <a ngbNavLink class="rounded-0 pt-2 pb-2">
                      <i class="mdi mdi-clipboard-text me-1"></i>
                      <span class="d-none d-sm-inline">Ponderación</span>
                    </a>
                    <ng-template ngbNavContent>
                      <div class="row" formGroupName="assessment">
                        <div class="col-12">
                          <div class="row mb-3">
                            <label class="col-md-12 col-form-label"
                              >Motivo de consulta (según el trabajador social)</label
                            >
                            <div class="col-md-12">
                              <textarea
                                class="form-control"
                                formControlName="consultationReason"
                                rows="4"
                                placeholder="Describa la situación desde la perspectiva del trabajador social..."
                              ></textarea>
                            </div>
                          </div>

                          <div class="row mb-3">
                            <label class="col-md-12 col-form-label"
                              >Describa la situación identificada (Ponderación)</label
                            >
                            <div class="col-md-12">
                              <textarea
                                class="form-control"
                                formControlName="weighting"
                                rows="4"
                                placeholder="Describa la situación identificada..."
                              ></textarea>
                            </div>
                          </div>

                          <div class="row mb-3">
                            <label class="col-md-12 col-form-label"
                              >Describa las condiciones favorables que identifica</label
                            >
                            <div class="col-md-12">
                              <textarea
                                class="form-control"
                                formControlName="concurrentFactors"
                                rows="4"
                                placeholder="Identifique factores que favorecen el proceso..."
                              ></textarea>
                            </div>
                          </div>

                          <div class="row mb-3">
                            <label class="col-md-12 col-form-label"
                              >Describa condiciones que no favorecen el proceso de ayuda</label
                            >
                            <div class="col-md-12">
                              <textarea
                                class="form-control"
                                formControlName="criticalFactors"
                                rows="4"
                                placeholder="Identifique obstáculos o factores críticos..."
                              ></textarea>
                            </div>
                          </div>

                          <div class="row mb-3">
                            <label class="col-md-12 col-form-label"
                              >Indique el enfoque teórico desde el cual abordará el proceso de ayuda</label
                            >
                            <div class="col-md-12">
                              <textarea
                                class="form-control"
                                formControlName="problemAnalysis"
                                rows="6"
                                placeholder="Describa el marco teórico y enfoque metodológico..."
                              ></textarea>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Botones de navegación -->
                      <ul class="list-inline mb-0 wizard">
                        <li class="previous list-inline-item">
                          <button type="button" class="btn btn-secondary" (click)="goToPreviousStep()">Anterior</button>
                        </li>
                        <li class="next list-inline-item float-end">
                          <button type="button" class="btn btn-secondary" (click)="goToNextStep()">Siguiente</button>
                        </li>
                      </ul>
                      <!-- Botones de navegación -->
                    </ng-template>
                  </li>

                  <!-- Plan de Intervención -->
                  <li [ngbNavItem]="11">
                    <a ngbNavLink class="rounded-0 pt-2 pb-2">
                      <i class="mdi mdi-clipboard-check me-1"></i>
                      <span class="d-none d-sm-inline">Plan de Intervención</span>
                    </a>
                    <ng-template ngbNavContent>
                      <div class="row" formGroupName="interventionPlan">
                        <div class="col-12">
                          <div class="row mb-3">
                            <label class="col-md-12 col-form-label">Plan de Intervención Detallado</label>
                            <div class="col-md-12">
                              <textarea
                                class="form-control"
                                formControlName="description"
                                rows="10"
                                placeholder="Describa detalladamente el plan de intervención, incluyendo objetivos, estrategias, actividades, recursos necesarios y cronograma..."
                              >
                              </textarea>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Botones de navegación -->
                      <ul class="list-inline mb-0 wizard">
                        <li class="previous list-inline-item">
                          <button type="button" class="btn btn-secondary" (click)="goToPreviousStep()">Anterior</button>
                        </li>
                        <li class="next list-inline-item float-end">
                          <button type="button" class="btn btn-secondary" (click)="goToNextStep()">Siguiente</button>
                        </li>
                      </ul>
                    </ng-template>
                  </li>

                  <!-- Notas de Progreso -->
                  <li [ngbNavItem]="12">
                    <a ngbNavLink class="rounded-0 pt-2 pb-2">
                      <i class="mdi mdi-note-text me-1"></i>
                      <span class="d-none d-sm-inline">Notas de Progreso</span>
                    </a>
                    <ng-template ngbNavContent>
                      <div class="table-responsive">
                        <table class="table table-bordered table-hover">
                          <thead class="table-light">
                            <tr>
                              <th width="120">FECHA</th>
                              <th width="100">HORA</th>
                              <th>TIPO DE ABORDAJE</th>
                              <th>PROCESO</th>
                              <th>RESUMEN DE INTERVENCIÓN</th>
                              <th>OBSERVACIONES</th>
                              <th>ACUERDOS</th>
                              <th width="80">ACCIONES</th>
                            </tr>
                          </thead>
                          <tbody formArrayName="progressNotes">
                            @for ( nota of progressNotes.controls; track nota; let i = $index) {
                            <tr [formGroupName]="i" class="align-middle">
                              <!-- Fecha -->
                              <td>
                                <input
                                  type="date"
                                  class="form-control"
                                  formControlName="date"
                                  [class.is-invalid]="
                                    nota.get('fecha')?.invalid &&
                                    (nota.get('fecha')?.dirty || nota.get('fecha')?.touched)
                                  "
                                />
                                @if ( nota.get('fecha')?.invalid && (nota.get('fecha')?.dirty ||
                                nota.get('fecha')?.touched) ) {
                                <div class="invalid-feedback">La fecha es requerida</div>
                                }
                              </td>
                              <!-- Hora -->
                              <td>
                                <input type="time" class="form-control" formControlName="time" />
                              </td>
                              <!-- Tipo de Abordaje -->
                              <td>
                                <input
                                  type="text"
                                  class="form-control"
                                  formControlName="approachType"
                                  [class.is-invalid]="
                                    nota.get('tipoAbordaje')?.invalid &&
                                    (nota.get('tipoAbordaje')?.dirty || nota.get('tipoAbordaje')?.touched)
                                  "
                                />
                                @if ( nota.get('tipoAbordaje')?.invalid && (nota.get('tipoAbordaje')?.dirty ||
                                nota.get('tipoAbordaje')?.touched) ) {
                                <div class="invalid-feedback">El tipo de abordaje es requerido</div>
                                }
                              </td>
                              <!-- Proceso -->
                              <td>
                                <input type="text" class="form-control" formControlName="process" />
                              </td>
                              <!-- Resumen -->
                              <td>
                                <textarea
                                  class="form-control"
                                  formControlName="summary"
                                  rows="2"
                                  [class.is-invalid]="
                                    nota.get('resumen')?.invalid &&
                                    (nota.get('resumen')?.dirty || nota.get('resumen')?.touched)
                                  "
                                ></textarea>
                                @if ( nota.get('resumen')?.invalid && (nota.get('resumen')?.dirty ||
                                nota.get('resumen')?.touched) ) {
                                <div class="invalid-feedback">El resumen es requerido</div>
                                }
                              </td>
                              <!-- Observaciones -->
                              <td>
                                <textarea class="form-control" formControlName="observations" rows="2"></textarea>
                              </td>
                              <!-- Acuerdos -->
                              <td>
                                <textarea class="form-control" formControlName="agreements" rows="2"></textarea>
                              </td>
                              <!-- Acciones -->
                              <td class="text-center">
                                <button
                                  class="btn btn-danger btn-sm"
                                  (click)="removeProgressNote(i)"
                                  [disabled]="progressNotes.length <= 1"
                                  title="Eliminar nota"
                                >
                                  <i class="mdi mdi-delete"></i>
                                </button>
                              </td>
                            </tr>
                            }
                          </tbody>
                        </table>

                        <div class="d-flex justify-content-end mt-2">
                          <button class="btn btn-primary btn-sm" (click)="addProgressNote()" title="Agregar nueva nota">
                            <i class="mdi mdi-plus"></i> Agregar Nota
                          </button>
                        </div>
                      </div>
                      <!-- Botones de navegación -->
                    </ng-template>
                  </li>

                  <!-- Referidos -->
                  <li [ngbNavItem]="13">
                    <a ngbNavLink class="rounded-0 pt-2 pb-2">
                      <i class="mdi mdi-account-arrow-right me-1"></i>
                      <span class="d-none d-sm-inline">Referidos</span>
                    </a>
                    <ng-template ngbNavContent>
                      <div class="row" formGroupName="referrals">
                        <div class="col-12">
                          <label>V. MENCIONAR Y JUSTIFICAR LOS REFERIDOS QUE SE REALIZARÁN</label>
                          <textarea class="form-control" formControlName="description" rows="6"></textarea>
                        </div>
                      </div>
                      <!-- Botones de navegación -->
                    </ng-template>
                  </li>

                  <!-- Nota de Cierre -->
                  <li [ngbNavItem]="14">
                    <a ngbNavLink class="rounded-0 pt-2 pb-2">
                      <i class="mdi mdi-bookmark-check me-1"></i>
                      <span class="d-none d-sm-inline">Nota de Cierre</span>
                    </a>
                    <ng-template ngbNavContent>
                      <div class="row" formGroupName="closingNote">
                        <div class="col-12">
                          <textarea class="form-control" formControlName="observations" rows="10"></textarea>
                        </div>
                      </div>

                      <ul class="list-inline mb-0 wizard">
                        <div class="float-end">
                          <li class="previous list-inline-item">
                            <button class="btn btn-secondary" (click)="goToPreviousStep()">Anterior</button>
                          </li>
                          <li class="next list-inline-item float-end">
                            <button type="submit" class="btn btn-primary" [disabled]="participantForm.invalid">
                              Finalizar y Guardar
                            </button>
                          </li>
                        </div>
                      </ul>
                    </ng-template>
                  </li>
                </ul>

                <div [ngbNavOutlet]="progressWizard" class="b-0 mb-0 pt-0"></div>
              </div>
              <!-- end #basicwizard-->
            </form>
          </div>

          <ng-template #noForm>
            <div class="alert alert-danger">
              <h5>Error: Formulario no inicializado</h5>
              <p>El formulario no se ha podido inicializar correctamente. Por favor, recarga la página.</p>
            </div>
          </ng-template>
        </div>
        <!-- end card-body -->
      </div>
      <!-- end card-->
    </div>
    <!-- end col -->
  </div>
</div>
